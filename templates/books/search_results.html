{% extends '_base.html' %}
{% load static %}

{% block title %}Search{% endblock title %}
{% block content %}
<div id='dim_wrapper' style='width:100%; height:100%; z-index:10'>

    <h1><a href="{% url 'home' %}" class="text-secondary search-results-title">search results</a></h1>

    <form class="form-inline mt-2 mt-md-0 mb-4" action="{% url 'search_results' %}" method="get">
        <input name="api_q" style="width:100%" class="form-control mr-sm-2" type="text" placeholder="try searching again here to make double sure!" aria-label="try searching again here to make double sure!">
    </form>

        <div id="search_result_div" style="opacity: 0; transition: opacity 1s ease;">

            {{ user.is_authenticated|json_script:"valid_user" }}
            {{ user.email_addresses_str|json_script:"email_address_list" }}

            <table class='table table-striped table-sortable' style="border-radius: 10px; overflow: hidden; transition: transform 1s ease;">
                <thead>

                    {% comment %} <th></th> <!--save book for later button--> {% endcomment %}
                    <th style="width:20%">author</th>
                    <th style="width:50%">title</th>
                    <th style="white-space:nowrap">file-type</th>
                    {% comment %} <th>links</th> <th></th> <!--Queue/add-to-cart button--> {% endcomment %}
                    <th></th> <!--send now button-->

                </thead>
                <br>
                    {% for book in book_list %}
                        <form method="POST" id="book_send_form_{{book.pk}}">
                            {% csrf_token %}
                            <tr>
                                {% comment %} <td><button class='btn-sm btn-secondary' style='white-space:nowrap'>save book</button></td>{% endcomment %}
                                <td>{{book.author}}</td>
                                <td>{{book.title}}</td>
                                <td>{{book.filetype}}</td>
                                <td>
                                    <input type="hidden" id="book_{{forloop.counter}}" name="{{book.ssn}}" value="{{book.json_links}}">
                                    <button class='btn-sm btn-primary' type="submit" style='white-space:nowrap'>send</button>
                                </td> 
                            </tr>
                        </form>
                    {% endfor %}
            </table>

        </div>

</div>

<script>
    $(document).ready(function () {
        // Fade in the search results and animate the table
        $("#search_result_div").css("opacity", "1");
        $(".table-sortable").css("transform", "translateY(0)");

        // ...rest of your code
    });
</script>
{% endblock content %}
